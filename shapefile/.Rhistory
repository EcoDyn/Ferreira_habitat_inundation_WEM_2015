install.packages("keras")
keras::install_keras()
devtools::install_github("rstudio/keras")
install.packages("devtool", dep=T)
install.packages("devtools", dep=T)
devtools::install_github("rstudio/keras")
keras::install_keras()
keras::install_keras(version = version = '1.8.0')
keras::install_keras(version = '1.8.0')
library(tensorflow)
install_tensorflow()
?install_tensorflow
?install_tensorflow(version = '1.8.0')
install_tensorflow(version = '1.8.0')
devtools::install_github("rstudio/tensorflow")
install_tensorflow()
keras::install_keras()
tensorflow::install_tensorflow(version = '1.8.0')
tensorflow::install_tensorflow(version = "1.8.0")
tensorflow::install_tensorflow(version = "https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-1.8.0-cp36-cp36m-linux_x86_64.whl")
# required libraries
librray(raster)
# required libraries
library(raster)
setwd("~/Projects/Ferreira_habitat_inundation_WEM_2015/shapefile/")
hab <- shapefile("mami_veget.shp")
inun <- shapefile("mami_inund.shp")
crs(hab)
crs(inun)
library(dplyr)
head(hab)
head(inun)
hab@data[12345,]
hab@FID[12345,]
names(hab)
hab@polygons$ID[12345]
names(hab@polygons)
hab@polygons[[12345]]]
hab@polygons[[12345]]
hab@polygons[[12345]][1]
hab@polygons[[12345]][[1]]
hab@polygons[[12345]]
hab@polygons[[12345]]$ID
hab@polygons[[12345]]
inund@polygons[[12345]]
inun@polygons[[12345]]
2^12
hab@polygons[[12345]]@ID
inun@polygons[[12345]]@ID
hab@polygons[[35876]]@ID
hab@polygons[[5876]]@ID
inun@polygons[[5876]]@ID
plot(hab[hab@polygons[[5876]]@ID == 5676])
plot(hab[hab@polygons[['ID' == 5676])
plot(hab[hab[[5876]])
plot(hab[[5876]])
plot(hab[['ID' = 5876]])
plot(inun[inun@polygons[[]]@ID == 5876])
plot(inun[inun@polygons[]@ID == 5876])
plot(inun[[5876]])
plot(inun@polygons[[5876]])
head(hab)
head(inun)
hab@data$area_km <- NULL
head(hab)
str(hab@data)
# Now, we rename the field and the classes
names(hab@data) <- "class"
head(hab)
library(forcats)
?forcats
hab@data$class <- as.factor(hab@data$class)
levels(hab@data$class)
hab@data$class <- fct_recode(hab@data$class,
low_varzea = 'V. Baixa',
high_varzea = 'V. Alta',
herb_soil = 'Herbaceas-Solo',
chavascal = 'Chavascal',
water_bodies = 'Agua')
head(hab)
# Add class codes
hab@data <- hab@data %>% mutate(class_code = fct_recode(class,
LV = 'low_varzea',
HV = 'high_varzea',
HS = 'herb_soil',
CH = 'chavascal',
WB = 'water_bodies'))
head(hab)
# Add formatted class labels
hab@data <- hab@data %>% mutate(class_name = fct_recode(class,
'Low Várzea' = 'low_varzea',
'High Várzea' = 'high_varzea',
'Hernaceous / Soil' = 'herb_soil',
'Chavascal' = 'chavascal',
'Water Bodies' = 'water_bodies'))
head(hab)
hab <- shapefile("mami_veget.shp")
hab@data$area_km <- NULL
# Now, we rename the veget field,  convert it to factor, and relabel the classes
names(hab@data) <- "class"
hab@data$class <- as.factor(hab@data$class)
hab@data$class <- fct_recode(hab@data$class,
low_varzea = 'V. Baixa',
high_varzea = 'V. Alta',
herb_soil = 'Herbaceas-Solo',
chavascal = 'Chavascal',
water_bodies = 'Agua')
# Add class codes
hab@data <- hab@data %>% mutate(class_acro = fct_recode(class,
LV = 'low_varzea',
HV = 'high_varzea',
HS = 'herb_soil',
CH = 'chavascal',
WB = 'water_bodies'))
# Add formatted class labels
hab@data <- hab@data %>% mutate(class_name = fct_recode(class,
'Low Várzea' = 'low_varzea',
'High Várzea' = 'high_varzea',
'Herbaceous / Soil' = 'herb_soil',
'Chavascal' = 'chavascal',
'Water Bodies' = 'water_bodies'))
hab@data <- hab@data %>% mutate(class_code = fct_recode(class,
'2' = 'low_varzea',
'1' = 'high_varzea',
'4 / Soil' = 'herb_soil',
'3' = 'chavascal',
'5' = 'water_bodies'))
head(hab)
hab@data <- hab@data %>% mutate(class_code = fct_recode(class,
'2' = 'low_varzea',
'1' = 'high_varzea',
'4' = 'herb_soil',
'3' = 'chavascal',
'5' = 'water_bodies'))
head(hab)
names(inun)
hab@data <- cbind(hab@data,inun@data)
head(hab)
names(hab@data)[6:7] <- c("flooding_stage","flood_duration")
head(hab)
names(hab@data)[6:7] <- c("fl_stage","fl_durat")
head(hab)
names(hab@data)[5:7] <- c("area_km2", "fl_stage","fl_durat")
head(hab)
tail(hab)
head(hab,30)
head(hab@data[hab@data$class == 'water_bodies'])
head(hab@data[hab@data$class == 'water_bodies',])
# Remove flooding stage of zero, because it is actually NA
hab@data$fl_stage[hab@data$fl_stage ==0] <- NA
head(hab@data[hab@data$class == 'water_bodies',])
head(hab,30)
# Renaming
names(hab@data)[5:7] <- c("area_km2", "fl_stage","fl_dur_day")
# Renaming
names(hab@data)[5:7] <- c("area_km2", "fl_stage_m","fl_dur_day")
# Rename inundation duration classes
hab@data$fl_dur_day <- as.factor(hab@data$fl_dur_day)
levels(hab@data$fl_dur_day)
hab@data$class <- fct_recode(hab@data$class,
"<40" = '<40 dias',
">295" = '>295 dias',
"105-125" = '105-125 dias',
"125-175" = '125-175 dias',
"175-295" = '175-295 dias',
"40-105" = "40-105 dias",
"365" = "365 dias",
"0" = "Não Inundado")
# Rename inundation duration classes
hab@data$fl_dur_day <- as.factor(hab@data$fl_dur_day)
hab@data$class <- fct_recode(hab@data$fl_dur_day,
"<40" = '<40 dias',
">295" = '>295 dias',
"105-125" = '105-125 dias',
"125-175" = '125-175 dias',
"175-295" = '175-295 dias',
"40-105" = "40-105 dias",
"365" = "365 dias",
"0" = "Não Inundado")
head(hab)
source('~/Projects/Ferreira_habitat_inundation_WEM_2015/scripts/aggregate_hab_inun.R')
head(hab)
source('~/Projects/Ferreira_habitat_inundation_WEM_2015/scripts/aggregate_hab_inun.R')
head(hab)
setwd("~/Projects/Ferreira_habitat_inundation_WEM_2015/shapefile/")
hab <- shapefile("mami_veget.shp")
inun <- shapefile("mami_inund.shp")
head(hab)
head(inun)
hab@data$area_km <- NULL
head(hab)
# Now, we rename the veget field,  convert it to factor, and relabel the classes
names(hab@data) <- "class"
hab@data$class <- as.factor(hab@data$class)
hab@data$class <- fct_recode(hab@data$class,
low_varzea = 'V. Baixa',
high_varzea = 'V. Alta',
herb_soil = 'Herbaceas-Solo',
chavascal = 'Chavascal',
water_bodies = 'Agua')
head(hab)
# Add class codes
hab@data <- hab@data %>% mutate(class_acro = fct_recode(class,
LV = 'low_varzea',
HV = 'high_varzea',
HS = 'herb_soil',
CH = 'chavascal',
WB = 'water_bodies'))
head(hab)
# Add formatted class labels
hab@data <- hab@data %>% mutate(class_name = fct_recode(class,
'Low Várzea' = 'low_varzea',
'High Várzea' = 'high_varzea',
'Herbaceous / Soil' = 'herb_soil',
'Chavascal' = 'chavascal',
'Water Bodies' = 'water_bodies'))
head(hab)
hab@data <- hab@data %>% mutate(class_code = fct_recode(class,
'2' = 'low_varzea',
'1' = 'high_varzea',
'4' = 'herb_soil',
'3' = 'chavascal',
'5' = 'water_bodies'))
head(hab)
# Now we bring in the relevan columns from inunf
hab@data <- cbind(hab@data,inun@data)
head(hab)
# Renaming
names(hab@data)[5:7] <- c("area_km2", "fl_stage_m","fl_dur_day")
head(hab)
# Remove flooding stage of zero, because it is actually NA
hab@data$fl_stage[hab@data$fl_stage ==0] <- NA
head(hab)
# Rename inundation duration classes
hab@data$fl_dur_day <- as.factor(hab@data$fl_dur_day)
source('~/Projects/Ferreira_habitat_inundation_WEM_2015/scripts/aggregate_hab_inun.R')
head(hab)
# sum areas - does this match the paper
areas <- hab@data %>% group_by(class) %>% sumarize(area = sum(area_km2))
# sum areas - does this match the paper
areas <- hab@data %>% group_by(class) %>% summarize(area = sum(area_km2))
areas
head(hab)
bas <- shapefile("mamiraua_basic_habitats.shp")
bas
bas@data
head(hab)
bas@data <- bas@data[,c('class','class_acro',"class_name','class_code','area_km2)]
bas@data <- bas@data[,c('class','class_acro','class_name','class_code','area_km2')]
bas@data
# Save results
shapefile(bas, "mamiraua_basic_habitats.shp", overwrite=TRUE)
shapefile(hab, "mamiraua_inundation_habitat.shp")
